<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>第十五届上海国际电影节快速购票_在线电影票预订_排片 - 格瓦拉生活网</title>
<meta name="keywords" content="第15届上海国际电影节_电影专题_电影节排片表下载_在线购票_格瓦拉生活网"/>
<meta name="description" content="第15届上海国际电影节_电影专题_电影节排片表下载_在线购票_格瓦拉生活网"/>
<link rel="stylesheet" type="text/css" href="${staticPath}css/gewara.css?n=layout&v=$VmUtils.jsVersion"/>
<script type="text/javascript" src="${staticPath}scripts/mootools.js"></script>
<script type="text/javascript" src="${staticPath}scripts/gewara.js?n=gewara-util,gewara-util,noobSlide,pagesNavigation,slimbox,base_home,index_even&v=$VmUtils.jsVersion"></script>
#parse('subject/filmfest/2012/style.vm')
	<style type="text/css">
	.opilist_lc{background:url(${staticPath}styles/filmfest/opilist_lc.jpg) no-repeat;width:940px;height:61px;}
	.opilist_main{border:1px solid #ccc;clear:both;overflow:hidden;width:938px;border-radius:5px 5px 5px 5px;}
	.opilist_main .inner{padding:15px;}
	.opilist_list a{padding:0 5px;margin-right:5px;display:inline-block;}
	.opilist_list a.select{background-color:#C03B0C;color:#fff;text-decoration:none !important;}
	.opilist_list .ul-80 li{ clear:both;color:gray;height:100%;margin:0 0 8px;overflow:hidden;padding-left:70px;}
	.opilist_buy{width:922px;margin-left:-7px;*margin-left:-7px;overflow:hidden;}
	.opilist_buy li{float:left;}
	.opilist_buy li.lump{width:454px;margin-left:10px;*margin-left:6px;}
	.opilist_buy_text{overflow:hidden;}
	.opilist_buy_text h2 {font-size:12px;font-weight:bold}
	.opilist_buy_text em{color:#777;}
	.filmListAera ul li{width:446px; height:130px; overflow:hidden; float:left;}
	.filmListAera .uiText p{width:336px; height:20px; white-space:nowrap; overflow:hidden;}
	.onShow{width:336px; height:62px; border:1px solid #f2f2f2; position:relative; margin-top:5px;}
	.onShow ul li{text-align:center; display:inline; width:110px; height:54px; margin:1px; float:left; line-height:18px; padding:3px 0; background:#fff3f3;}
	.onShow ul li.nothing{
		background: #eaeaea; /* Old browsers */
		background: -moz-linear-gradient(top, #eaeaea 0%, #ffffff 100%); /* FF3.6+ */
		background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#eaeaea), color-stop(100%,#ffffff)); /* Chrome,Safari4+ */
		background: -webkit-linear-gradient(top, #eaeaea 0%,#ffffff 100%); /* Chrome10+,Safari5.1+ */
		background: -o-linear-gradient(top, #eaeaea 0%,#ffffff 100%); /* Opera11.10+ */
		background: -ms-linear-gradient(top, #eaeaea 0%,#ffffff 100%); /* IE10+ */
		filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#eaeaea', endColorstr='#ffffff',GradientType=0 ); /* IE6-9 */
		background: linear-gradient(top, #eaeaea 0%,#ffffff 100%); /* W3C */
	}
	.filmListAera .uiText .onShow p{width:110px; line-height:15px;}
	.onShow ul{position:absolute;}
	.onShow ul a{color:#c30;}
	.onShow .eventses{display:block; width:22px; height:37px; background:#f00; position:absolute; top:12px; z-index:10; cursor:pointer;}
	.onShow .even_left{left:-5px; background:url(${staticPath}styles/filmfest/leftArrow.png) no-repeat;_background-image:none;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/styles/filmfest/leftArrow.png',sizingMethod = 'crop');}
	.onShow .even_right{right:-5px; background:url(${staticPath}styles/filmfest/rightArrow.png) no-repeat;_background-image:none;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/styles/filmfest/rightArrow.png',sizingMethod = 'crop');}
	.onShow .even_center{position:relative; width:336px; height:61px; overflow:hidden;}
	.onShow .even_center div{position:absolute; left:0; top:0;}
	.shareWb{width:175px; height:44px; display:block; text-indent:-9999px; overflow:hidden; background:url(${staticPath}styles/filmfest/talk_time.png) -2px -282px no-repeat;}
	</style>
</head>
<body>
#set($hasLogo = false)
#set($tag = 'ticketselect')
#parse('subject/filmfest/2012/header.vm')
<form name="searchFilmForm" action="${basePath}filmfest/fifteenMovieList.xhtml" id="searchFilmForm" method="get">
	<input type="hidden" name="date" id="date" value="$!VmUtils.escapeHtml($params.date)" />
	<input type="hidden" name="flag" id="flag" value="$!VmUtils.escapeHtml($params.flag)"/>
	<input type="hidden" name="state" id="state" value="$!VmUtils.escapeHtml($params.state)"/>
	<input type="hidden" name="type"  id="type" value="$!VmUtils.escapeHtml($params.type)"/>
	<input type="hidden" name="cinemaid" id="cinemaid" value="$!VmUtils.escapeHtml($params.cinemaid)"/>
</form>
<div id="ui_layout" class="ui_layout"> 
	<div style="width:940px;padding:0 10px 90px 10px;background:#fff;overflow:hidden;">
		<div class="opilist_lc mt20">
		</div>
		<div class="mt10" style="text-align:right;font-size:14px;"><em class="c666">温馨提示：</em>先<a href="${basePath}home/charge.xhtml" target="_blank" class="cMovie">充值</a>，使用余额支付比使用网银支付节省<b class="cMovie">70%</b>时间</div>
		<div class="opilist_main mt10">
			<div class="inner">
				<div class="opilist_list">
					<ul class="ul-80 clear">
						<li>
							<div class="ul-80Inner">放映时间：</div>
							<a #if($VmUtils.isNull($params.date))class="select"#end href="${basePath}filmfest/fifteenMovieList.xhtml">全部</a>
							#foreach($i in [16..24])
							#set($curSelectDate = '2012-06-'+$i)
							<a #if($params.date eq $curSelectDate) class="select" #end href="javascript:searchFilmMovie('date','$!curSelectDate')">6月$!i日</a>
							#end
						</li>
						<li>
							<div class="ul-80Inner">电影类型：</div>
							#set($typeList = ['动作','喜剧','爱情','科幻','灾难','惊悚','纪录','犯罪','战争','历史','动画','黑色电影','其他'])
							<a #if($VmUtils.isNull($!params.type)) class="select"#end href="${basePath}filmfest/fifteenMovieList.xhtml">全部</a>
							#foreach($type in $typeList)
								<a #if($!params.type eq $type) class="select" #end href="javascript:searchFilmMovie('type','$!type');">$type</a>
							#end
						</li>
						<li>
							#set($flagList = ['官方推荐', '向大师致敬', '经典再现', '触摸3D', '多元视角', '金爵奖', '亚洲新人奖', '展映单元', 'MIDA纪录片'])
							<div class="ul-80Inner">单元类型：</div>
							<a #if($VmUtils.isNull($params.flag)) class="select"#end href="${basePath}filmfest/fifteenMovieList.xhtml">全部</a>
							#foreach($flag in $flagList)
								<a #if($params.flag eq $flag) class="select" #end href="javascript:searchFilmMovie('flag','$flag');">$flag</a>
							#end
						</li>
						<li>
							<div class="ul-80Inner">放映影院：</div>
							<a #if($VmUtils.isNull($params.cinemaid))class="select"#end href="${basePath}filmfest/fifteenMovieList.xhtml">全部</a>
							#foreach($cinema in $cinemaList)
							<a #if($params.cinemaid eq $cinema.id) class="select" #end href="javascript:searchFilmMovie('cinemaid','$!cinema.id')">$!cinema.name</a>
							#end
						</li>
						<li>
							#set($stateList = ['中国', '日本', '韩国', '泰国', '美国', '英国', '法国', '德国', '巴西', '加拿大', '意大利'])
							<div class="ul-80Inner">国家/地区：</div>
							<a #if($VmUtils.isNull($params.state)) class="select" #end href="${basePath}filmfest/fifteenMovieList.xhtml">全部</a>
							#foreach($state in $stateList)
							<a #if($params.state eq $state) class="select" #end href="javascript:searchFilmMovie('state','$state');">$!state</a>
							#end
						</li>
						<li style="margin:0px;padding-bottom:10px;">
							<div class="ul-80Inner">影片查询：</div>
							<form action="${basePath}filmfest/fifteenMovieList.xhtml" id="searchMovieName">
							<input type="text" title="请输入搜索关键词" value="$!VmUtils.escapeHtml($params.moviename)" name="moviename" id="moviename" style="padding:4px 4px 5px;width:280px;border:1px solid #a6a6a6;height:14px;margin-left:7px;" class="text left" />
							<input type="button" value="搜 索" onclick="searchMovieName()" style="height:25px;background-position:-25px -104px;width:82px; cursor:pointer;" class="inIco left"/>
							</form>
						</li>
					</ul>
				</div>
				<div class="opilist_buy mt20">
					<ul>
						#if($VmUtils.isEmptyList($movieList))
						<div class="ui_warning center">没有查询到符合条件的电影，请重新搜索。</div>
						#else
							#foreach($movie in $movieList)
							<li class="mt20 #if($foreach.count%2 eq 1)mr15#end">
								<div class="uipic" style="width:96px; overflow:hidden;">
									<a target="_blank" href="${basePath}movie/$!movie.id" title="$!movie.moviename"><img width="96" height="128" src="$VmUtils.randomPic('cw96h128',$!movie.logo)" /></a>
								</div>
								<div class="uiText" style="width:340px;">
									<p><a href="${basePath}movie/$!movie.id" target="_blank" title="$!movie.moviename" class="bold">$!movie.moviename</a></p>
									<p title="$!movie.highlight"><em>看点：</em>$!VmUtils.escabbr($!movie.highlight,48)</p>
									<p><em>语言/片长：</em>$!movie.language#if($movie.videolen)/$!movie.videolen分钟#end</p>
									<div class="onShow clear"  id="movie$!movie.id">
										#set($movieMpiList = $movieOpiMap.get($movie.id))
										#if($VmUtils.gt($VmUtils.size($movieMpiList),3))<div title="向左滚动" class="even_left eventses"></div>#end
										<div class="even_center">
											<ul>
												#foreach($mpi in $movieMpiList)
												#set($cinema = $cinemaMap.get($mpi.cinemaid))
												#set($mpiPlayDate = $DateUtil.format($mpi.playdate,'MM月dd日'))
												#set($mpitime = $mpiPlayDate + ' ['+ $DateUtil.getCnWeek($mpi.playdate)+'] '+$mpi.playtime)
												#set($opiDate = $mpi.playdate + ' '+$mpi.playtime)
												<li>
													<p>$mpiPlayDate $mpi.playtime</p>
													<p class="c666" title="$!cinema.briefname">$!VmUtils.escabbr($!cinema.briefname,16)</p>
													<p>
													#if($movieOpiStatusMap.get($mpi.id).booking)
													<a class="right mr10" href="${basePath}cinema/order/step1.shtml?mpid=$mpi.id" target="_blank">立即购票</a>
													#elseif($movieOpiStatusMap.get($mpi.id).closed)
													<span class="right mr10 c999">已关闭</span>
													#else
													<a class="right mr10 cGym" href="javascript:void(0);" onclick="opiTips('$!movie.moviename','$!movie.videolen','$!cinema.countyname','$!cinema.name','$mpitime','$!cinema.id','$!movie.id','$opiDate','$mpi.id');">添加提醒</a>
													#end
													#if($!mpi.gewaprice)<span class="left ml10 mPrice">¥$!mpi.gewaprice</span>#end
													</p>
												</li>
												#end
												#if($VmUtils.gt(3,$VmUtils.size($movieMpiList)))
												#set($y = 3-$VmUtils.size($movieMpiList))
												#foreach($x in [1..$y])
												<li class="nothing"></li>
												#end
												#end
												
											</ul>
										</div>
										#if($VmUtils.gt($VmUtils.size($movieMpiList),3))<div title="向右滚动" class="even_right eventses"></div>#end
									</div>
								</div>
							</li>
							#end
						#end
					</ul>
				</div>
				<div class="page">
					#parse('include/pageUtil.vm')
				</div>
			</div>
		</div>	
	</div>
</div>
<div id="opiTips" style="display:none;">
	<div style="padding:10px 30px;">
		<input type="hidden" name="mprelatedid" id="mprelatedid"/>
		<input type="hidden" name="mpcategoryid" id="mpcategoryid"/>
		<input type="hidden" name="playdate" id="playdate"/>
		<input type="hidden" name="mpid" id="mpid"/>
		<p class="cMovie">添加日程后你将在场次开放购票后收到短信提醒</p>
		<dl class="dl-80 mt20 clear">
			<dt>手机号码：</dt>
			<dd>
				<input style="font-size:18px; width:160px; font-weight:bold;" name="mobile" id="mobile" type="text" class="text"/>
			</dd>
		</dl>
		<dl class="dl-80 clear">
			<dt>购票数量：</dt>
			<dd>
				<select name="wantBuyNumber" id="wantBuyNumber">
					<option value="1">1</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5</option>
				</select>
			</dd>
		</dl>
		<p style="padding-left:80px;" class="mt20"><a class="button bigBt redBt" href="javascript:void(0);" onclick="saveTips();"><span>添加提醒</span></a></p>
		<div class="opiTipsMovie">
			<p class="c333"><b>确认影片信息</b></p>
			<p><em>影片：</em><span class="c333" id="tipsMoviename"></span> <span class="ffst" id="tipsMovieVideolen"></span></p>
			<p><em>影院：</em><span class="c333 ffst" id="tipsCountyName"></span><span class="c333" id="tipsCinemaname"></span></p>
			<p><em>场次：</em><span class="fs14 cMovie ffst" id="tipsMoviePlayDate"></span></p>
		</div>
	</div>
</div>
<div id="opiTipsSuccess" class="opiTipsSuccess" style="display:none;">
	<div style="padding:20px 30px;">
		<dl>
			<dt>添加场次开放购票提醒成功！</dt>
			<dd class="mt20"><a href="javascript:sharesTicketInfo();" title="分享到微博" class="shareWb">分享到微博</a></dd>
		</dl>
	</div>
</div>
<script type="text/javascript">
window.addEvent('domready',function(){
	new DefaultValue('moviename','请输入搜索关键词');
	#foreach($movie in $movieList)
	new evengo({'parent':'movie$movie.id','times':1,'width':112,'allwidth':336});
	#end
});
function searchFilmMovie(field,value){
	$(field).value = value;
	$('searchFilmForm').submit();
}
function searchMovieName(){
	var moviename = $('moviename').value;
	if(!$chk(moviename) || moviename == '请输入搜索关键词'){
		gewaUtil.alert('请输入要查询电影的关键字！');
		return;
	}
	$('searchMovieName').submit();
}
function opiTips(moviename,movielen,countyname,cinemaname,playdate,cinemaid,movieid,playtime,mpid){
	checkLogin(true,function(){
		$('tipsMoviename').innerHTML = moviename;
		$('tipsMovieVideolen').innerHTML = "["+movielen+"分钟]";
		$('tipsCountyName').innerHTML = "["+countyname+"]";
		$('tipsCinemaname').innerHTML = cinemaname;
		$('tipsMoviePlayDate').innerHTML = playdate;
		$('mprelatedid').value=cinemaid;
		$('mpcategoryid').value=movieid;
		$('playdate').value=playtime;
		$('mpid').value=mpid;
		gewa.util.maskContent('','opiTips','格瓦拉提示你',350,'notTitle');
	});
}
function saveTips(){
	var values = {'mptag':'cinema','mprelatedid':$('mprelatedid').value,'mpcategoryid':$('mpcategoryid').value,'playdate':$('playdate').value,'mobile':$('mobile').value,'mpid':$('mpid').value,'wantBuyNumber':$('wantBuyNumber').value};
	gewara.util.sendRequest('${basePath}filmfest/savePlayItemMessage.xhtml',values,function(result){
		if(result.success){
			opiTipsSuccess();
		}else{
			gewaUtil.alert(result.msg);
		}
		gewa.util.container['notTitle'].dispose('notTitle');
	});
}
function opiTipsSuccess(){
	gewa.util.maskContent('','opiTipsSuccess','格瓦拉提示你',350,'notTitle2');
}
function sharesTicketInfo(){
	gewara.util.sendRequest('${basePath}ajax/member/synchroizaInfo.xhtml',{'rights':'moviecomment'},function(result){
		if(result.success){
			if(result.appList){
				if(result.appList.contains('sina')){
					var content = '我在 @格瓦拉生活网 添加了 上海国际电影节 '+$('playdate').value+' '+$('tipsCinemaname').innerHTML+'《'+$('tipsMoviename').innerHTML+'》的场次开放购票免费短信提醒，开放购票能收到短信通知，很贴心哦！http://www.gewara.com/filmfest/fifteen.xhtml ';
					gewara.util.sendRequest('${basePath}filmfest/sharesTicketInfo.xhtml',{'content':content},function(result){
						if(result.success){
							gewa.util.container['notTitle2'].dispose('notTitle2');
							gewaUtil.alert("分享成功！");
						}else{
							gewaUtil.alert(result.msg);
						}
					});
				}else{
					syscData('${basePath}home/bind/sina/userApp.xhtml?source=close','新浪微博','sina');
				}
			}
		}
	});
}
function syscData(url,title,tag,el){
	var html = "",width=600;
	if(tag == 'sina'){
		html = new Element('iframe',{
			'frameborder':0,
			'scrolling':'no',
			'height':'368',
			'width':'600',
			'src':url
		});
	}else{
		html = new Element('div',{
			'styles':{
				'width':'620px',
				'height':window.ActiveXObject?'380px':'330px',
				'overflow':'hidden'
			}
		});
		new Element('iframe',{
			'frameborder':0,
			'scrolling':'no',
			'height':'850',
			'width':'810',
			'src':url,
			'styles':{
				'margin-top':'-280px',
				'margin-left':'-160px'
			}
		}).inject(html);
		width = 650;
	}
	gewa.util.maskContent('',html,'正在设置'+title+'的同步',width,'syscing');
}
var isBind = function(el){
	if($(el)){
		$(el).checked = true;
		isWbOpen = false;
	}
	if(gewa.util.container['syscing'])gewa.util.container['syscing'].dispose('syscing');
}
</script>
#parse('include/bottom.vm')
</body>
</html>