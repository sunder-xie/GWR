package test;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class LogRegExp {

  public static void main(String argv[]) {
	String logEntryLine = "180.172.35.111 - - [02/Aug/2013:18:59:14 +0800] \"GET http://www.gewara.com/getCaptchaId.xhtml? HTTP/1.1\" 200 454 \"http://www.gewara.com/login.xhtml?TARGETURL=%2Fcinema%2Forder%2Fstep1.shtml%3Fmpid%3D17723628&lineNum=14&rankNum=40&priceRange=110&priceRange=110&seatMap=ZL%2CZL%2CZL%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CZL%2CZL%2CZL%40%40ZL%2CZL%2CZL%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CZL%2CZL%2CZL%40%40ZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%40%40ZL%2CZL%2CZL%2CZL%2CZL%2CA%2CA%2CA%2CZL%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CZL%2CA%2CA%2CA%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%40%40ZL%2CZL%2CZL%2CZL%2CZL%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%40%40ZL%2CZL%2CZL%2CZL%2CZL%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%40%40ZL%2CZL%2CZL%2CZL%2CZL%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%40%40ZL%2CZL%2CZL%2CZL%2CZL%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%40%40ZL%2CZL%2CZL%2CZL%2CZL%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%40%40ZL%2CZL%2CZL%2CZL%2CZL%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CZL%2CZL%2CZL%2CZL%2CZL%2CZL%40%40A%2CA%2CA%2CZL%2CZL%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CZL%2CZL%2CZL%2CA%2CA%2CA%40%40A%2CA%2CA%2CZL%2CZL%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CZL%2CZL%2CZL%2CA%2CA%2CA%40%40A%2CA%2CA%2CZL%2CZL%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CZL%2CZL%2CZL%2CA%2CA%2CA%40%40A%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA%2CA&ticketPath=%2Fticket2%2F\" \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/6.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; Shuame; SE 2.X MetaSr 1.0)\"";
    String logEntryPattern = "^([\\d.]+) (\\S+) (\\S+) \\[([\\w:/]+\\s[+\\-]\\d{4})\\] \"(.+?)\" (\\d{3}) (\\d+) \"([^\"]+)\" \"([^\"]+)\"";

    System.out.println("Using RE Pattern:");
    System.out.println(logEntryPattern);

    System.out.println("Input line is:" + logEntryLine);
    System.out.println();

    Pattern p = Pattern.compile(logEntryPattern);
    Matcher matcher = p.matcher(logEntryLine);
    System.out.println("IP Address: " + matcher.group(1));
    System.out.println("Date&Time: " + matcher.group(4));
    System.out.println("Request: " + matcher.group(5));
    System.out.println("Response: " + matcher.group(6));
    System.out.println("Bytes Sent: " + matcher.group(7));
    if (!matcher.group(8).equals("-"))
      System.out.println("Referer: " + matcher.group(8));
    System.out.println("Browser: " + matcher.group(9));
  }
}